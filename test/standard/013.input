*-------------------------------------------------------------------------------
* Molecule: H2O
* Basis: None
* Symmetry: C1
* Features tested: FALSE
* Responsible person: I. Fdez. GalvÃ¡n
* Comments: Geometry optimization with external program
*-------------------------------------------------------------------------------
&GATEWAY
  * Just one s function to keep GATEWAY happy
  Coord = 3

    O.ANO-S...1s -0.000000  0.000000  1.342757
    H.ANO-S...0s -1.929898  0.000000 -1.144049
    H.ANO-S...0s  1.929898  0.000000 -1.144049
  Group = NoSym
>>> DoWhile
&SEWARD
  OneOnly
&FALSE
  RUN = python3 LJ.py
&SLAPAF
>>> EndDo

>>> FILE LJ.py
# This script computes energies and gradients for a Lennard-Jones model
import sys
import math

infile = sys.argv[1]
outfile = sys.argv[2]

angstrom = 1.88972612462
kcalmol = 0.00159360143764

# ====================================
# From UFF  doi: 10.1021/ja00051a040
#        D_i             x_i
params = {
  'H':  [2.886*angstrom, 0.044*kcalmol],
  'HE': [2.362*angstrom, 0.056*kcalmol],
  'LI': [2.452*angstrom, 0.025*kcalmol],
  'BE': [2.745*angstrom, 0.085*kcalmol],
  'B':  [4.083*angstrom, 0.180*kcalmol],
  'C':  [3.851*angstrom, 0.105*kcalmol],
  'N':  [3.660*angstrom, 0.069*kcalmol],
  'O':  [3.500*angstrom, 0.060*kcalmol],
  'F':  [3.364*angstrom, 0.050*kcalmol],
  'NE': [3.243*angstrom, 0.042*kcalmol],
  'NA': [2.983*angstrom, 0.030*kcalmol],
  'MG': [3.021*angstrom, 0.111*kcalmol],
  'AL': [4.499*angstrom, 0.505*kcalmol],
  'SI': [4.295*angstrom, 0.402*kcalmol],
  'P':  [4.147*angstrom, 0.305*kcalmol],
  'S':  [4.035*angstrom, 0.274*kcalmol],
  'CL': [3.947*angstrom, 0.227*kcalmol],
  'AR': [3.868*angstrom, 0.185*kcalmol],
}

def LJ_grad(i, j):
  n_i = names[i]
  n_j = names[j]
  x_i = params[n_i][0]
  x_j = params[n_j][0]
  D_i = params[n_i][1]
  D_j = params[n_j][1]
  x_ij = (x_i+x_j)/2
  D_ij = math.sqrt(D_i*D_j)
  d = [b-a for a,b in zip(geo[i],geo[j])]
  r2 = sum([a**2 for a in d])
  x6 = x_ij**6/r2**3
  x12 = x6**2
  E = D_ij*(x12-2*x6)
  g = D_ij*(x6-x12)*12/r2
  vg = [-g*a for a in d]
  return E, vg
# ====================================

# Read input geometry
names = []
geo = []
with open(infile, 'r') as f:
  for line in f:
    if line.startswith('[XYZ]'):
      nAtoms = int(f.readline())
      f.readline()
      for i in range(nAtoms):
        l = f.readline().split()
        names.append(l[0].upper())
        geo.append([float(x)*angstrom for x in l[1:4]])

# Compute energy and gradient
E = 0
grad = [[0.0, 0.0, 0.0]] * nAtoms
for i in range(nAtoms):
  for j in range(i+1, nAtoms):
    E_ij, g_ij = LJ_grad(i,j)
    E += E_ij
    grad[i] = [a+b for a,b in zip(grad[i],g_ij)]
    grad[j] = [a-b for a,b in zip(grad[j],g_ij)]

# Write output
with open(outfile, 'w') as f:
  f.write('[ROOTS]\n')
  f.write('1\n')
  f.write('\n')
  f.write('[ENERGIES]\n')
  f.write(f'{E}\n')
  f.write('\n')
  f.write('[GRADIENT]\n')
  f.write('1\n')
  for i in range(nAtoms):
    f.write(f'{grad[i][0]} {grad[i][1]} {grad[i][2]}\n')
>>> EOF

>>FILE checkfile
* This file is autogenerated:
* Molcas version 21.06-18-gaf7448c0e
* Linux lucifer 5.8.0-53-generic #60~20.04.1-Ubuntu SMP Thu May 6 09:52:46 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
* Tue Jun 22 12:53:56 2021
*
#>>   1
#> POTNUC="2.826853703238"/12
#>>   2
#> POTNUC="2.826853703238"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.473513300497"/5
#>>   3
#>>   4
#>>   6
#> POTNUC="2.831416299494"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.473184087709"/5
#>>   7
#>>   8
#>>  10
#> POTNUC="2.842149835668"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.473071528525"/5
#>>  11
#>>  12
#>>  14
#> POTNUC="2.836436535785"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.472263264670"/5
#>>  15
#>>  16
#>>  18
#> POTNUC="2.832094374273"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.471623955568"/5
#>>  19
#>>  20
#>>  22
#> POTNUC="2.828793154091"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.471112306029"/5
#>>  23
#>>  24
#>>  26
#> POTNUC="2.826299394178"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.470699122101"/5
#>>  27
#>>  28
#>>  30
#> POTNUC="2.824432529418"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.470361867456"/5
#>>  31
#>>  32
#>>  34
#> POTNUC="2.823062118346"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.470084267673"/5
#>>  35
#>>  36
#>>  38
#> POTNUC="2.822131665505"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.469859227287"/5
#>>  39
#>>  40
#>>  42
#> POTNUC="2.821536112346"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.469673750760"/5
#>>  43
#>>  44
#>>  46
#> POTNUC="2.821215009823"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.469520400385"/5
#>>  47
#>>  48
#>>  50
#> POTNUC="2.821120162355"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.469393310965"/5
#>>  51
#>>  52
#>>  54
#> POTNUC="2.821212297369"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.469287780381"/5
#>>  55
#>>  56
#>>  58
#> POTNUC="2.821458946655"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.469200010998"/5
#>>  59
#>>  60
#>>  62
#> POTNUC="2.821832856426"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.469126916812"/5
#>>  63
#>>  64
#>>  66
#> POTNUC="2.822310777516"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.469065977276"/5
#>>  67
#>>  68
#>>  70
#> POTNUC="2.822872537917"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.469015124926"/5
#>>  71
#>>  72
#>>  74
#> POTNUC="2.823500332830"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468972657910"/5
#>>  75
#>>  76
#>>  78
#> POTNUC="2.824178189288"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468937171183"/5
#>>  79
#>>  80
#>>  82
#> POTNUC="2.824891576721"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468907501862"/5
#>>  83
#>>  84
#>>  86
#> POTNUC="2.825627143679"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468882685494"/5
#>>  87
#>>  88
#>>  90
#> POTNUC="2.826372565481"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468861920804"/5
#>>  91
#>>  92
#>>  94
#> POTNUC="2.827116488495"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468844541110"/5
#>>  95
#>>  96
#>>  98
#> POTNUC="2.827848554805"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468829991036"/5
#>>  99
#>> 100
#>> 102
#> POTNUC="2.828559487175"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468817807444"/5
#>> 103
#>> 104
#>> 106
#> POTNUC="2.829241209770"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468807603779"/5
#>> 107
#>> 108
#>> 110
#> POTNUC="2.829886976776"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468799057166"/5
#>> 111
#>> 112
#>> 114
#> POTNUC="2.830491480440"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468791897750"/5
#>> 115
#>> 116
#>> 118
#> POTNUC="2.831050913414"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468785899874"/5
#>> 119
#>> 120
#>> 122
#> POTNUC="2.831562967615"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468780874754"/5
#>> 123
#>> 124
#>> 126
#> POTNUC="2.832026762192"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468776664403"/5
#>> 127
#>> 128
#>> 130
#> POTNUC="2.832442704437"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468773136565"/5
#>> 131
#>> 132
#>> 134
#> POTNUC="2.832812297322"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468770180501"/5
#>> 135
#>> 136
#>> 138
#> POTNUC="2.833137913670"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468767703470"/5
#>> 139
#>> 140
#>> 142
#> POTNUC="2.833422559126"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468765627797"/5
#>> 143
#>> 144
#>> 146
#> POTNUC="2.833669644138"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468763888413"/5
#>> 147
#>> 148
#>> 150
#> POTNUC="2.833882780476"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468762430811"/5
#>> 151
#>> 152
#>> 154
#> POTNUC="2.834065611923"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468761209323"/5
#>> 155
#>> 156
#>> 158
#> POTNUC="2.834221682969"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468760185689"/5
#>> 159
#>> 160
#>> 162
#> POTNUC="2.834354344715"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468759327851"/5
#>> 163
#>> 164
#>> 166
#> POTNUC="2.834466694049"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468758608949"/5
#>> 167
#>> 168
#>> 170
#> POTNUC="2.834561540432"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468758006475"/5
#>> 171
#>> 172
#> GEO_ITER="43"/8
#> POTNUC="2.834641394180"/6
#> SEWARD_MLTPL1X="0.0"/5
#> SEWARD_KINETIC="29.213922007819"/5
#> SEWARD_ATTRACT="-61.468757501569"/5
#>> 173
>>EOF
