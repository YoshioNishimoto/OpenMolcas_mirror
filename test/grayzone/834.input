*-------------------------------------------------------------------------------
* Molecule: Water dimer
* Basis: cc-pVDZ
* Symmetry: C1
* Features tested: Molcas/Gromacs interface
* Responsible person: Michael Stenrup
* Comments: Only run test if interface is installed
*-------------------------------------------------------------------------------
* Test if Gromacs is available and skip the test if not
> RM -FORCE TEST_GROMACS
> IF ( $MOLCAS_DRIVER = UNKNOWN_VARIABLE )
>   EXPORT MOLCAS_DRIVER=molcas
> ENDIF
> SHELL $MOLCAS_DRIVER have_feature gromacs || touch TEST_GROMACS
> IF ( -FILE TEST_GROMACS )
>   EXIT 36
> ENDIF
*-------------------------------------------------------------------------------
> FILE conf.gro
Water dimer
   6
    1SOLQM   OW    1   -.155   -.011    .000
    1SOLQM  HW1    2   -.193    .076    .000
    1SOLQM  HW2    3   -.039   -.012   -.000
    2SOL     OW    4    .224    .016    .116
    2SOL    HW1    5    .264   -.036    .046
    2SOL    HW2    6    .253   -.035    .177
   1.0 1.0 1.0
> EOF
*-------------------------------------------------------------------------------
> FILE index.ndx
[ System ]
 1 2 3 4 5 6
[ QM ]
 1 2 3
[ MM ]
 4 5 6
> EOF
*-------------------------------------------------------------------------------
> FILE topol.top
#include "oplsaa.ff/forcefield.itp"
#include "oplsaa.ff/spc.itp"
#include "spcqm.itp"

[ system ]
 Water dimer

[ molecules ]
 SOLQM 1
 SOL 1
> EOF
*-------------------------------------------------------------------------------
> FILE spcqm.itp
[ moleculetype ]
 SOLQM 2

[ atoms ]
 1 opls_116 1 SOLQM  OW 1 -0.82
 2 opls_117 1 SOLQM HW1 1  0.41
 3 opls_117 1 SOLQM HW2 1  0.41

[ bonds ]
 1 2 5
 1 3 5
> EOF
*-------------------------------------------------------------------------------
> FILE grompp.mdp
define = -DFLEXIBLE

cutoff-scheme = group
pbc = no
rlist = 0

coulombtype = cut-off
rcoulomb = 0

vdwtype = cut-off
rvdw = 0

QMMM = yes
QMMM-grps = QM
QMMMscheme = slave
QMmethod = CASSCF
QMbasis = STO-3G
> EOF
*-------------------------------------------------------------------------------
> SHELL grompp_d -n index
> EXPORT GMX_NB_GENERIC=1
> EXPORT GMX_MAXBACKUP=-1

&GATEWAY
Gromacs
 Simple
Basis
 cc-pVDZ
Group
 NoSym
NoCD

> DO WHILE

&SEWARD

&ESPF
External
 Gromacs
MMIterations
 1000

&SCF

&SLAPAF
Cartesian

> ENDDO
>>FILE checkfile
* This file is autogenerated:
* Molcas version 20.10-241-g70ed4f8b
* Linux otis 4.15.0-1073-oem #83-Ubuntu SMP Mon Feb 17 11:21:18 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux
* Sat Nov 28 09:24:22 2020
*
#>>   1
#> POTNUC="8.406904165079"/12
#>>   2
#> POTNUC="8.406904165079"/6
#> SEWARD_MLTPL1X="-2.929075493170"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.151990197910"/5
#>>   3
#> POTNUC="8.330488832533"/6
#>>   4
#> SCF_ITER="10"/8
#> E_SCF="-75.970962302007"/8
#> ESPF_MULTIPOLES[0]="-0.752820096086"/6
#> ESPF_MULTIPOLES[1]="0.386250889294"/6
#> ESPF_MULTIPOLES[2]="0.366389942735"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.514593287981"/5
#> MLTPL__1[1]="0.613221017850"/5
#> MLTPL__1[2]="0.0"/5
#> MLTPL__2[0]="1.888518000998"/5
#> MLTPL__2[1]="-1.190723807540"/5
#> MLTPL__2[2]="0.0"/5
#> MLTPL__2[3]="0.040538519192"/5
#> MLTPL__2[4]="0.0"/5
#> MLTPL__2[5]="-1.929056520190"/5
#>>   5
#> GRAD[0]="-0.115071545502"/6
#> GRAD[1]="0.019677516499"/6
#> GRAD[2]="0.0"/6
#> GRAD[3]="-0.021208716273"/6
#> GRAD[4]="-0.002032951735"/6
#> GRAD[5]="0.0"/6
#> GRAD[6]="0.136280261775"/6
#> GRAD[7]="-0.017644564764"/6
#> GRAD[8]="0.0"/6
#> GRAD[0]="-0.111080115286"/6
#> GRAD[1]="0.022570624867"/6
#> GRAD[2]="0.000909608877"/6
#> GRAD[3]="-0.020148849201"/6
#> GRAD[4]="-0.004584954806"/6
#> GRAD[5]="-0.000382971619"/6
#> GRAD[6]="0.130114236068"/6
#> GRAD[7]="-0.018539509168"/6
#> GRAD[8]="-0.001527677522"/6
#>>   6
#>>   7
#>>   9
#> POTNUC="8.964756533429"/6
#> SEWARD_MLTPL1X="-2.858374093539"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.216936667048"/5
#>>  10
#> POTNUC="8.652464178582"/6
#>>  11
#> SCF_ITER="9"/8
#> E_SCF="-76.033427843639"/8
#> ESPF_MULTIPOLES[0]="-0.799409329979"/6
#> ESPF_MULTIPOLES[1]="0.367625562227"/6
#> ESPF_MULTIPOLES[2]="0.431962586739"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.579671642056"/5
#> MLTPL__1[1]="0.680092385012"/5
#> MLTPL__1[2]="0.000000000002"/5
#> MLTPL__2[0]="1.485720946942"/5
#> MLTPL__2[1]="-0.805905744285"/5
#> MLTPL__2[2]="-0.000000000014"/5
#> MLTPL__2[3]="0.240616358738"/5
#> MLTPL__2[4]="0.000000000000"/5
#> MLTPL__2[5]="-1.726337305680"/5
#>>  12
#> GRAD[0]="-0.070564394544"/6
#> GRAD[1]="-0.015274312230"/6
#> GRAD[2]="-0.000000000001"/6
#> GRAD[3]="-0.012190418223"/6
#> GRAD[4]="0.012117057048"/6
#> GRAD[5]="-0.000000000001"/6
#> GRAD[6]="0.082754812767"/6
#> GRAD[7]="0.003157255182"/6
#> GRAD[8]="0.000000000001"/6
#> GRAD[0]="-0.042521691372"/6
#> GRAD[1]="-0.006566012593"/6
#> GRAD[2]="0.001258635464"/6
#> GRAD[3]="-0.008482059033"/6
#> GRAD[4]="0.006943052596"/6
#> GRAD[5]="0.000100538239"/6
#> GRAD[6]="0.049736328311"/6
#> GRAD[7]="-0.000221652699"/6
#> GRAD[8]="-0.002191363480"/6
#>>  13
#>>  14
#>>  16
#> POTNUC="9.415434092927"/6
#> SEWARD_MLTPL1X="-2.803566819831"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.270533019770"/5
#>>  17
#> POTNUC="9.130952055063"/6
#>>  18
#> SCF_ITER="8"/8
#> E_SCF="-76.035184583243"/8
#> ESPF_MULTIPOLES[0]="-0.798394195529"/6
#> ESPF_MULTIPOLES[1]="0.368077914394"/6
#> ESPF_MULTIPOLES[2]="0.430593770721"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.505879843815"/5
#> MLTPL__1[1]="0.698300890804"/5
#> MLTPL__1[2]="-0.000000000005"/5
#> MLTPL__2[0]="1.208535097175"/5
#> MLTPL__2[1]="-0.725132607059"/5
#> MLTPL__2[2]="-0.000000000019"/5
#> MLTPL__2[3]="0.364624635951"/5
#> MLTPL__2[4]="-0.000000000002"/5
#> MLTPL__2[5]="-1.573159733126"/5
#>>  19
#> GRAD[0]="0.015432009517"/6
#> GRAD[1]="-0.007480747778"/6
#> GRAD[2]="-0.000000000002"/6
#> GRAD[3]="-0.003205780159"/6
#> GRAD[4]="0.006304948796"/6
#> GRAD[5]="-0.000000000000"/6
#> GRAD[6]="-0.012226229358"/6
#> GRAD[7]="0.001175798982"/6
#> GRAD[8]="0.000000000003"/6
#> GRAD[0]="0.038481883326"/6
#> GRAD[1]="0.002448553717"/6
#> GRAD[2]="0.000945731410"/6
#> GRAD[3]="0.000037190819"/6
#> GRAD[4]="0.000883723082"/6
#> GRAD[5]="0.000089777884"/6
#> GRAD[6]="-0.038881414609"/6
#> GRAD[7]="-0.003243911408"/6
#> GRAD[8]="-0.001398633154"/6
#>>  20
#>>  21
#>>  23
#> POTNUC="9.228454643617"/6
#> SEWARD_MLTPL1X="-2.831523691190"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.248124051541"/5
#>>  24
#> POTNUC="8.931717728858"/6
#>>  25
#> SCF_ITER="8"/8
#> E_SCF="-76.036369149317"/8
#> ESPF_MULTIPOLES[0]="-0.796384505769"/6
#> ESPF_MULTIPOLES[1]="0.367347290280"/6
#> ESPF_MULTIPOLES[2]="0.429302522362"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.538614034999"/5
#> MLTPL__1[1]="0.692737867073"/5
#> MLTPL__1[2]="-0.000000000005"/5
#> MLTPL__2[0]="1.311604930455"/5
#> MLTPL__2[1]="-0.731634195969"/5
#> MLTPL__2[2]="-0.000000000022"/5
#> MLTPL__2[3]="0.318321995179"/5
#> MLTPL__2[4]="-0.000000000001"/5
#> MLTPL__2[5]="-1.629926925634"/5
#>>  26
#> GRAD[0]="-0.030534561891"/6
#> GRAD[1]="-0.010166118905"/6
#> GRAD[2]="-0.000000000002"/6
#> GRAD[3]="-0.004513228270"/6
#> GRAD[4]="0.005531215286"/6
#> GRAD[5]="-0.000000000000"/6
#> GRAD[6]="0.035047790161"/6
#> GRAD[7]="0.004634903619"/6
#> GRAD[8]="0.000000000002"/6
#> GRAD[0]="-0.005593468979"/6
#> GRAD[1]="-0.000417716844"/6
#> GRAD[2]="0.001004058938"/6
#> GRAD[3]="-0.001235503961"/6
#> GRAD[4]="0.000090739785"/6
#> GRAD[5]="0.000087009879"/6
#> GRAD[6]="0.005970592388"/6
#> GRAD[7]="0.000394162869"/6
#> GRAD[8]="-0.001622875150"/6
#>>  27
#>>  28
#>>  30
#> POTNUC="9.255388164688"/6
#> SEWARD_MLTPL1X="-2.828578689472"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.251306488396"/5
#>>  31
#> POTNUC="8.958646511431"/6
#>>  32
#> SCF_ITER="7"/8
#> E_SCF="-76.036402360973"/8
#> ESPF_MULTIPOLES[0]="-0.796319250687"/6
#> ESPF_MULTIPOLES[1]="0.367122679758"/6
#> ESPF_MULTIPOLES[2]="0.429462235064"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.535426777244"/5
#> MLTPL__1[1]="0.694030497802"/5
#> MLTPL__1[2]="-0.000000000005"/5
#> MLTPL__2[0]="1.294796624429"/5
#> MLTPL__2[1]="-0.724204860064"/5
#> MLTPL__2[2]="-0.000000000021"/5
#> MLTPL__2[3]="0.326127943467"/5
#> MLTPL__2[4]="-0.000000000001"/5
#> MLTPL__2[5]="-1.620924567897"/5
#>>  33
#> GRAD[0]="-0.025426032356"/6
#> GRAD[1]="-0.009846888593"/6
#> GRAD[2]="-0.000000000002"/6
#> GRAD[3]="-0.003877043916"/6
#> GRAD[4]="0.005207164350"/6
#> GRAD[5]="-0.000000000000"/6
#> GRAD[6]="0.029303076272"/6
#> GRAD[7]="0.004639724243"/6
#> GRAD[8]="0.000000000003"/6
#> GRAD[0]="-0.000504462523"/6
#> GRAD[1]="0.000005563460"/6
#> GRAD[2]="0.001014952028"/6
#> GRAD[3]="-0.000601851369"/6
#> GRAD[4]="-0.000248177600"/6
#> GRAD[5]="0.000086696020"/6
#> GRAD[6]="0.000383870391"/6
#> GRAD[7]="0.000352646216"/6
#> GRAD[8]="-0.001605140869"/6
#>>  34
#> GEO_ITER="5"/8
#> POTNUC="9.257753358202"/6
#> SEWARD_MLTPL1X="-2.828388072720"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.251580157591"/5
#> POTNUC="8.961020870892"/6
#> SCF_ITER="4"/8
#> E_SCF="-76.036402454980"/8
#> ESPF_MULTIPOLES[0]="-0.796225065980"/6
#> ESPF_MULTIPOLES[1]="0.367057061026"/6
#> ESPF_MULTIPOLES[2]="0.429433546440"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.535185225490"/5
#> MLTPL__1[1]="0.694259478870"/5
#> MLTPL__1[2]="-0.000000000005"/5
#> MLTPL__2[0]="1.292851981687"/5
#> MLTPL__2[1]="-0.722826500194"/5
#> MLTPL__2[2]="-0.000000000021"/5
#> MLTPL__2[3]="0.327182309875"/5
#> MLTPL__2[4]="-0.000000000001"/5
#> MLTPL__2[5]="-1.620034291562"/5
#>>  35
#>>  36
>>EOF
